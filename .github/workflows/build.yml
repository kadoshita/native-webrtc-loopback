name: Build

on:
  push:

jobs:
  build-macos:
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@v2
    - name: get libwebrtc
      run: |
        wget https://github.com/shiguredo-webrtc-build/webrtc-build/releases/download/m84.4105.0.0/webrtc.macos.tar.gz
        tar xvzf webrtc.macos.tar.gz
    - name: build
      run: |
        mkdir build
        cd build
        cmake .. -DTARGET="macos"
        cmake --build .
        
  build-windows:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - name: install wget unzip
        run: |
          @powershell -NoProfile -ExecutionPolicy unrestricted -Command "iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))" && SET PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin
          choco install Wget
          choco install unzip
      - name: get libwebrtc
        run: |
          wget https://github.com/shiguredo-webrtc-build/webrtc-build/releases/download/m84.4105.0.0/webrtc.windows.zip
          unzip webrtc.windows.zip
          ls
      - name: build
        run: |
          mkdir build
          cd build
          cmake .. -G "Visual Studio 16 2019" -DTARGET="windows"
          cmake --build . --config Release
